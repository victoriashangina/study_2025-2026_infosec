# Makefile –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ1
# –ü—Ä–æ—Å—Ç–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –≤–µ—Ä—Å–∏—è

# –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
SRC = –õ01_–®–∞–Ω–≥–∏–Ω–∞_–æ—Ç—á—ë—Ç.md

# –¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã
PDF = –õ01_–®–∞–Ω–≥–∏–Ω–∞_–æ—Ç—á—ë—Ç.pdf
DOCX = –õ01_–®–∞–Ω–≥–∏–Ω–∞_–æ—Ç—á—ë—Ç.docx

# –°–æ–∑–¥–∞—Ç—å –≤—Å—ë (PDF –∏ DOCX)
all: pdf docx
	@echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:"
	@echo "   - $(PDF)"
	@echo "   - $(DOCX)"

# –°–æ–∑–¥–∞—Ç—å PDF (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —à—Ä–∏—Ñ—Ç–æ–≤)
pdf:
	@echo "üî® –°–æ–∑–¥–∞—é PDF —Ñ–∞–π–ª..."
	pandoc $(SRC) -o $(PDF) --pdf-engine=xelatex
	@echo "‚úÖ PDF —Å–æ–∑–¥–∞–Ω: $(PDF)"

# –°–æ–∑–¥–∞—Ç—å DOCX
docx:
	@echo "üî® –°–æ–∑–¥–∞—é DOCX —Ñ–∞–π–ª..."
	pandoc $(SRC) -o $(DOCX)
	@echo "‚úÖ DOCX —Å–æ–∑–¥–∞–Ω: $(DOCX)"

# –û—á–∏—Å—Ç–∫–∞
clean:
	rm -f $(PDF) $(DOCX)
	@echo "üßπ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
check:
	@echo "üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:"
	@ls -la image/ 2>/dev/null | wc -l | xargs echo "   –ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:"
	@echo "\nüìÑ –°—Å—ã–ª–∫–∏ –≤ –æ—Ç—á–µ—Ç–µ:"
	@grep -o "image/fig[0-9]*\.png" $(SRC) | sort -u || echo "   –ù–µ—Ç —Å—Å—ã–ª–æ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"

# –ü–æ–º–æ—â—å
help:
	@echo "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
	@echo "  make        - —Å–æ–∑–¥–∞—Ç—å PDF –∏ DOCX"
	@echo "  make pdf    - —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ PDF"
	@echo "  make docx   - —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ DOCX"
	@echo "  make clean  - —É–¥–∞–ª–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã"
	@echo "  make check  - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
